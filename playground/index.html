<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluent Widget Playground</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8fafc;
        }

        .playground {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: #1e293b;
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .version {
            background: #3b82f6;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
        }

        .main {
            flex: 1;
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            gap: 2rem;
        }

        .content {
            flex: 1;
        }

        .sidebar {
            width: 300px;
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 2rem;
        }

        .demo-section {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .demo-section h2 {
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .demo-section p {
            color: #64748b;
            margin-bottom: 1.5rem;
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }

        .control-group input,
        .control-group select,
        .control-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
        }

        .control-group input[type="checkbox"] {
            width: auto;
            margin-right: 0.5rem;
        }

        .control-group textarea {
            height: 80px;
            resize: vertical;
        }

        .color-input {
            width: 60px !important;
            height: 40px;
            padding: 4px;
            border-radius: 6px;
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s ease;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .btn:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #6b7280;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
        }

        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .status.online {
            background: #dcfce7;
            color: #166534;
        }

        .status.offline {
            background: #fef2f2;
            color: #991b1b;
        }

        .log {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 1rem;
            height: 200px;
            overflow-y: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.75rem;
            line-height: 1.4;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            padding: 0.25rem;
            border-radius: 3px;
        }

        .log-entry.info {
            background: #e0f2fe;
            color: #0c4a6e;
        }

        .log-entry.success {
            background: #dcfce7;
            color: #166534;
        }

        .log-entry.error {
            background: #fef2f2;
            color: #991b1b;
        }

        .log-entry.warn {
            background: #fef3c7;
            color: #92400e;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .product-image {
            height: 150px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .product-info {
            padding: 1rem;
        }

        .product-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .product-price {
            font-size: 1.25rem;
            color: #10b981;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .footer {
            background: #1e293b;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        @media (max-width: 768px) {
            .main {
                flex-direction: column;
                padding: 1rem;
            }

            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
            }

            .header-content {
                padding: 0 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="playground">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">ðŸš€ Fluent Widget Playground</div>
                <div class="version">v1.0.0-dev</div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main">
            <!-- Content Area -->
            <div class="content">
                <!-- Welcome Section -->
                <div class="demo-section">
                    <h2>Welcome to the Widget Playground!</h2>
                    <p>
                        This playground allows you to test the Fluent Chat Widget with different configurations
                        and see how it behaves in a real website environment. Use the controls on the right
                        to customize the widget appearance and behavior.
                    </p>

                    <div class="actions">
                        <button class="btn" onclick="openWidget()">Open Widget</button>
                        <button class="btn btn-secondary" onclick="closeWidget()">Close Widget</button>
                        <button class="btn btn-success" onclick="sendTestMessage()">Send Test Message</button>
                        <button class="btn btn-danger" onclick="showBadge()">Show Badge</button>
                        <button class="btn btn-small" onclick="clearLog()">Clear Log</button>
                    </div>

                    <div class="status" id="widgetStatus">Widget Status: Not Initialized</div>
                </div>

                <!-- Demo Products Section -->
                <div class="demo-section">
                    <h2>Demo E-commerce Store</h2>
                    <p>
                        This simulates a real e-commerce website where customers might use the chat widget
                        to ask questions about products. Click on any product to automatically open the
                        widget with a relevant message.
                    </p>

                    <div class="product-grid">
                        <div class="product-card">
                            <div class="product-image">ðŸ’» Laptop Pro</div>
                            <div class="product-info">
                                <div class="product-title">UltraBook Pro 15"</div>
                                <div class="product-price">$1,299</div>
                                <button class="btn" onclick="askAboutProduct('UltraBook Pro 15 inch')">
                                    Ask About This Product
                                </button>
                            </div>
                        </div>

                        <div class="product-card">
                            <div class="product-image">âŒš Smart Watch</div>
                            <div class="product-info">
                                <div class="product-title">FitTracker Elite</div>
                                <div class="product-price">$299</div>
                                <button class="btn" onclick="askAboutProduct('FitTracker Elite smartwatch')">
                                    Ask About This Product
                                </button>
                            </div>
                        </div>

                        <div class="product-card">
                            <div class="product-image">ðŸŽ§ Headphones</div>
                            <div class="product-info">
                                <div class="product-title">SoundPods Max</div>
                                <div class="product-price">$199</div>
                                <button class="btn" onclick="askAboutProduct('SoundPods Max wireless earbuds')">
                                    Ask About This Product
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Event Log -->
                <div class="demo-section">
                    <h2>Event Log</h2>
                    <p>Monitor widget events and API calls in real-time:</p>
                    <div class="log" id="eventLog">
                        <div class="log-entry info">Playground loaded. Waiting for widget initialization...</div>
                    </div>
                </div>
            </div>

            <!-- Sidebar Controls -->
            <div class="sidebar">
                <h3 style="margin-bottom: 1rem;">Widget Configuration</h3>

                <!-- Basic Configuration -->
                <div class="control-group">
                    <label for="apiKey">API Key</label>
                    <input type="text" id="apiKey" value="demo_api_key_playground" placeholder="Enter API key">
                </div>

                <div class="control-group">
                    <label for="companyName">Company Name</label>
                    <input type="text" id="companyName" value="Demo Store" placeholder="Your Company">
                </div>

                <div class="control-group">
                    <label for="greeting">Greeting Message</label>
                    <textarea id="greeting" placeholder="Hi! How can we help you today?">Hi! ðŸ‘‹ Welcome to our Demo Store! I'm here to help you find the perfect products. What can I assist you with today?</textarea>
                </div>

                <!-- Appearance -->
                <div class="control-group">
                    <label for="primaryColor">Primary Color</label>
                    <input type="color" id="primaryColor" value="#3B82F6" class="color-input">
                </div>

                <div class="control-group">
                    <label for="position">Position</label>
                    <select id="position">
                        <option value="bottom-right">Bottom Right</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="top-right">Top Right</option>
                        <option value="top-left">Top Left</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="theme">Theme</label>
                    <select id="theme">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="auto">Auto</option>
                    </select>
                </div>

                <!-- Behavior -->
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="autoOpen">
                        Auto Open Widget
                    </label>
                </div>

                <div class="control-group">
                    <label>
                        <input type="checkbox" id="enableFileUpload" checked>
                        Enable File Upload
                    </label>
                </div>

                <div class="control-group">
                    <label>
                        <input type="checkbox" id="enableEmojis" checked>
                        Enable Emojis
                    </label>
                </div>

                <div class="control-group">
                    <label>
                        <input type="checkbox" id="enableSurvey" checked>
                        Enable Satisfaction Survey
                    </label>
                </div>

                <!-- Actions -->
                <div class="control-group">
                    <button class="btn" onclick="reinitializeWidget()" style="width: 100%; margin-bottom: 0.5rem;">
                        Apply Configuration
                    </button>
                    <button class="btn btn-secondary" onclick="resetConfiguration()" style="width: 100%;">
                        Reset to Defaults
                    </button>
                </div>

                <!-- Widget Status -->
                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e5e7eb;">
                    <h4 style="margin-bottom: 0.5rem;">Widget Status</h4>
                    <div id="statusIndicator" class="status offline">Not Initialized</div>
                    <div style="font-size: 0.75rem; color: #6b7280;">
                        <div>Visitor ID: <span id="visitorId">-</span></div>
                        <div>Conversation ID: <span id="conversationId">-</span></div>
                        <div>Is Open: <span id="isOpen">false</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2024 Fluent AI. This is a development playground for testing the chat widget.</p>
        </footer>
    </div>

    <!-- Widget Configuration -->
    <script>
        // Global widget configuration
        window.FluentWidgetConfig = {
            apiKey: 'demo_api_key_playground',
            apiUrl: 'http://localhost:3000/api', // Development API
            companyName: 'Demo Store',
            greeting: 'Hi! ðŸ‘‹ Welcome to our Demo Store! I\'m here to help you find the perfect products. What can I assist you with today?',
            placeholder: 'Ask about products, shipping, returns...',
            primaryColor: '#3B82F6',
            position: 'bottom-right',
            theme: 'light',
            autoOpen: false,
            enableFileUpload: true,
            enableEmojis: true,
            enableSatisfactionSurvey: true,

            // Event handlers for playground
            onReady: function() {
                log('Widget initialized successfully', 'success');
                updateStatus();
            },

            onOpen: function() {
                log('Widget opened', 'info');
                updateStatus();
            },

            onClose: function() {
                log('Widget closed', 'info');
                updateStatus();
            },

            onMessage: function(message, isUser, metadata) {
                log(`Message ${isUser ? 'sent' : 'received'}: "${message}"`, isUser ? 'info' : 'success');

                // Simulate AI responses for demo
                if (isUser) {
                    setTimeout(() => {
                        simulateAIResponse(message);
                    }, 1000 + Math.random() * 2000);
                }
            },

            onError: function(error) {
                log(`Error: ${error.message}`, 'error');
            }
        };

        // Logging functionality
        function log(message, type = 'info') {
            const logContainer = document.getElementById('eventLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function clearLog() {
            document.getElementById('eventLog').innerHTML = '';
            log('Log cleared', 'info');
        }

        // Status updates
        function updateStatus() {
            const statusEl = document.getElementById('statusIndicator');
            const widgetStatusEl = document.getElementById('widgetStatus');
            const visitorIdEl = document.getElementById('visitorId');
            const conversationIdEl = document.getElementById('conversationId');
            const isOpenEl = document.getElementById('isOpen');

            if (window.FluentWidget) {
                const isOpen = window.FluentWidget.isOpen();
                const visitorId = window.FluentWidget.getVisitorId();
                const conversationId = window.FluentWidget.getConversationId();

                statusEl.className = 'status online';
                statusEl.textContent = 'Initialized';
                widgetStatusEl.textContent = `Widget Status: ${isOpen ? 'Open' : 'Closed'}`;
                visitorIdEl.textContent = visitorId || '-';
                conversationIdEl.textContent = conversationId || '-';
                isOpenEl.textContent = isOpen ? 'true' : 'false';
            } else {
                statusEl.className = 'status offline';
                statusEl.textContent = 'Not Initialized';
                widgetStatusEl.textContent = 'Widget Status: Not Initialized';
                visitorIdEl.textContent = '-';
                conversationIdEl.textContent = '-';
                isOpenEl.textContent = 'false';
            }
        }

        // Widget control functions
        function openWidget() {
            if (window.FluentWidget) {
                window.FluentWidget.open();
            } else {
                log('Widget not initialized', 'error');
            }
        }

        function closeWidget() {
            if (window.FluentWidget) {
                window.FluentWidget.close();
            } else {
                log('Widget not initialized', 'error');
            }
        }

        function sendTestMessage() {
            if (window.FluentWidget) {
                window.FluentWidget.sendMessage('This is a test message from the playground!');
            } else {
                log('Widget not initialized', 'error');
            }
        }

        function showBadge() {
            if (window.FluentWidget) {
                const count = Math.floor(Math.random() * 5) + 1;
                window.FluentWidget.showBadge(count);
                log(`Badge shown with count: ${count}`, 'info');
            } else {
                log('Widget not initialized', 'error');
            }
        }

        function askAboutProduct(productName) {
            if (window.FluentWidget) {
                window.FluentWidget.open();
                setTimeout(() => {
                    window.FluentWidget.sendMessage(`I'm interested in learning more about the ${productName}. Can you tell me about its features and availability?`);
                }, 500);
            } else {
                log('Widget not initialized', 'error');
            }
        }

        // Configuration management
        function getConfigFromForm() {
            return {
                apiKey: document.getElementById('apiKey').value,
                companyName: document.getElementById('companyName').value,
                greeting: document.getElementById('greeting').value,
                primaryColor: document.getElementById('primaryColor').value,
                position: document.getElementById('position').value,
                theme: document.getElementById('theme').value,
                autoOpen: document.getElementById('autoOpen').checked,
                enableFileUpload: document.getElementById('enableFileUpload').checked,
                enableEmojis: document.getElementById('enableEmojis').checked,
                enableSatisfactionSurvey: document.getElementById('enableSurvey').checked,
                // Keep the event handlers
                ...window.FluentWidgetConfig
            };
        }

        function reinitializeWidget() {
            try {
                // Destroy existing widget
                if (window.FluentWidget) {
                    window.FluentWidget.destroy();
                }

                // Update configuration
                const newConfig = getConfigFromForm();
                window.FluentWidgetConfig = newConfig;

                // Reinitialize
                if (window.FluentWidget) {
                    window.FluentWidget.init(newConfig);
                    log('Widget reinitialized with new configuration', 'success');
                } else {
                    log('FluentWidget not loaded yet', 'warn');
                }
            } catch (error) {
                log(`Failed to reinitialize: ${error.message}`, 'error');
            }
        }

        function resetConfiguration() {
            document.getElementById('apiKey').value = 'demo_api_key_playground';
            document.getElementById('companyName').value = 'Demo Store';
            document.getElementById('greeting').value = 'Hi! ðŸ‘‹ Welcome to our Demo Store! I\'m here to help you find the perfect products. What can I assist you with today?';
            document.getElementById('primaryColor').value = '#3B82F6';
            document.getElementById('position').value = 'bottom-right';
            document.getElementById('theme').value = 'light';
            document.getElementById('autoOpen').checked = false;
            document.getElementById('enableFileUpload').checked = true;
            document.getElementById('enableEmojis').checked = true;
            document.getElementById('enableSurvey').checked = true;

            log('Configuration reset to defaults', 'info');
        }

        // AI response simulation
        function simulateAIResponse(userMessage) {
            const responses = [
                "Thanks for your question! I'd be happy to help you with that. Let me check our current inventory and pricing for you.",
                "Great choice! That product is very popular. We have it in stock and can ship it out today if you order before 3 PM.",
                "I can definitely help you compare those options. Would you like me to send you a detailed comparison?",
                "We're currently running a special promotion on that item. You can get 15% off with code DEMO15 at checkout!",
                "That's a fantastic question! Based on your needs, I'd recommend checking out our premium options. Would you like to see some alternatives?",
                "Perfect! I can connect you with one of our product specialists who can give you more detailed technical specifications. Would that be helpful?"
            ];

            // Simple keyword-based response selection
            let response = responses[Math.floor(Math.random() * responses.length)];

            if (userMessage.toLowerCase().includes('price') || userMessage.toLowerCase().includes('cost')) {
                response = "I'd be happy to help with pricing information! Our prices are very competitive, and we often have special promotions running. Would you like me to check current pricing for you?";
            } else if (userMessage.toLowerCase().includes('shipping')) {
                response = "We offer free shipping on orders over $50, and expedited shipping is available. Most orders ship within 24 hours. Where would you like it shipped?";
            } else if (userMessage.toLowerCase().includes('return')) {
                response = "We have a hassle-free 30-day return policy. If you're not completely satisfied, you can return any item for a full refund. No questions asked!";
            }

            // Simulate the AI response
            if (window.FluentWidget) {
                // This would normally come from the API, but for demo we'll simulate it
                log(`AI Response: "${response}"`, 'success');
            }
        }

        // Update status periodically
        setInterval(updateStatus, 1000);

        // Initial setup
        document.addEventListener('DOMContentLoaded', function() {
            log('Playground loaded and ready', 'info');
            updateStatus();
        });
    </script>

    <!-- Load the widget script -->
    <!-- In development, this would load from your local build -->
    <!-- <script src="../dist/fluent-widget.js"></script> -->

    <!-- For now, simulate the widget loading -->
    <script>
        // Simulate widget loading for demo
        setTimeout(() => {
            // Mock FluentWidget object for playground testing
            window.FluentWidget = {
                init: function(config) {
                    console.log('Mock widget initialized with config:', config);
                    log('Mock widget initialized (replace with real widget script)', 'warn');
                    updateStatus();
                    return this;
                },
                open: function() {
                    console.log('Mock widget opened');
                    log('Mock widget opened', 'info');
                    updateStatus();
                },
                close: function() {
                    console.log('Mock widget closed');
                    log('Mock widget closed', 'info');
                    updateStatus();
                },
                toggle: function() {
                    console.log('Mock widget toggled');
                },
                sendMessage: function(message) {
                    console.log('Mock message sent:', message);
                    log(`Mock message sent: "${message}"`, 'info');
                    return Promise.resolve({ success: true });
                },
                showBadge: function(count) {
                    console.log('Mock badge shown:', count);
                },
                hideBadge: function() {
                    console.log('Mock badge hidden');
                },
                isOpen: function() {
                    return Math.random() > 0.5; // Random for demo
                },
                getVisitorId: function() {
                    return 'demo_visitor_' + Math.random().toString(36).substr(2, 9);
                },
                getConversationId: function() {
                    return Math.random() > 0.7 ? 'demo_conv_' + Math.random().toString(36).substr(2, 9) : null;
                },
                destroy: function() {
                    console.log('Mock widget destroyed');
                    log('Mock widget destroyed', 'info');
                }
            };

            // Auto-initialize with config
            window.FluentWidget.init(window.FluentWidgetConfig);
        }, 1000);
    </script>
</body>
</html>